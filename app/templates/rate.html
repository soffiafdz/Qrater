{% extends "base.html" %}

{% block help_modal %}
{% include "help_modal.html" %}
{% endblock %}

{% block help_btn %}
<button
  type="button"
  style="width: 2.5rem"
  class="btn btn-dark "
  style="width:100%"
  data-bs-toggle="modal"
  data-bs-target="#helpModal">
  <i class="bi bi-question-circle-fill"></i>
</button>
{% endblock %}

{% block breadcrumb %}
<ol class="breadcrumb m-0">
  <li class="breadcrumb-item">
    <a
      class="text-decoration-none text-light"
      href="{{ url_for('main.dashboard') }}"
      >Dashboard</a>
  </li>
  <li class="breadcrumb-item">
    <a
      class="text-decoration-none text-light"
      href="{{ url_for('dt.datatable', dataset=DS.name) }}"
      >{{ DS.name }}</a>
  </li>
  <li class="breadcrumb-item">
    <a
      class="text-decoration-none text-light"
      href="{{ url_for('main.rate',
        dataset=DS.name) if filter is not none else '#' }}"
      >Rating</a>
  </li>
  {% if filter is not none %}
  <li class="breadcrumb-item">
    <a
      href="#"
      {%- if filter == 0 -%}
      class="text-decoration-none text-secondary"
      >Pending
      {%- elif filter == 1 -%}
      class="text-decoration-none text-success"
      >Pass
      {%- elif filter == 2 -%}
      class="text-decoration-none text-warning"
      >Warning
      {%- elif filter == 3 -%}
      class="text-decoration-none text-danger"
      >Fail
      {%- endif -%}
    </a>
  </li>
  {% endif %}
</ol>
{% endblock %}

{% block app_content %}
<div class="row">
  <h1 class="display-4 text-center">
    {{ img_name }}
    {% if rating == 0 %}
    <span class="badge rounded-pill bg-secondary">Pending</span>
    {% elif rating == 1 %}
    <span class="badge rounded-pill bg-success">Pass</span>
    {% elif rating == 2 %}
    <span class="badge rounded-pill bg-warning">Warning</span>
    {% elif rating == 3 %}
    <span class="badge rounded-pill bg-danger">Fail</span>
    {% endif %}
  </h1>
  <img
    src="{{ url_for('static', filename=(img_path)) }}"
    class="img-fluid"
    alt="{{ img_name }}"
    >
</div>
<div class="row my-3 justify-content-evenly">
  <div class="col-7">
    {% if pag %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <li class="page-item {% if not imgs.has_prev %}disabled{% endif %}">
          <a
            class="page-link"
            id="prevPage"
            href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
              page=imgs.prev_num) if imgs.has_prev else '#' }}"
              >
            <i class="bi-arrow-left"></i>
          </a>
        </li>
        {%- for page in imgs.iter_pages(right_current=3) %}
        {% if page %}
        {% if page != imgs.page %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
              page=page) }}"
            >{{ page }}</a>
        </li>
        {% else %}
        <li class="page-item active">
          <a
            class="page-link"
            href="#"
            >{{ page }}
          </a>
        </li>
        {% endif %}
        {% else %}
        <li class="page-item disabled">
          <a
            class="page-link"
            href="#"
            ><span class=ellipsis>...<span>
          </a></li>
          {% endif %}
          {%- endfor %}
          <li class="page-item {% if not imgs.has_next %}disabled{% endif %}">
            <a
              class="page-link"
              id="nextPage"
              href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
                page=imgs.next_num) if imgs.has_next else '#' }}">
              <i class="bi-arrow-right"></i>
            </a>
          </li>
      </ul>
    </nav>
    {% endif %}
  </div>
  <div class="col-5">
    <form method="post" id="ratingForm">
      {{ form.csrf_token() }}
      <div
        class="btn-toolbar"
        role="toolbar"
        aria-label="Toolbar with button groups"
        >
        <div class="form-check p-0">
          <div class="btn-group me-2" role="group" aria-label="First group">
            <input
              type="radio"
              name="rating"
              id="rating-0"
              class="btn-check"
              value="0"
              {% if rating == 0 %}checked{% endif %}
              >
              <label
                class="btn btn-outline-secondary{% if rating == 0 %} active{% endif %}"
                for="rating-0"
                >Pending
              </label>
          </div>
            <div class="btn-group me-2" role="group" aria-label="Second group">
              <input
                type="radio"
                name="rating"
                id="rating-1"
                class="btn-check"
                value="1"
                {% if rating == 1 %}checked{% endif %}
                >
                <label
                  class="btn btn-outline-success{% if rating == 1 %} active{% endif %}"
                  for="rating-1"
                  >Pass
                </label>
                  <input
                    type="radio"
                    name="rating"
                    id="rating-2"
                    class="btn-check"
                    value="2"
                    {% if rating == 2 %}checked{% endif %}
                    >
                    <label
                      class="btn btn-outline-warning{% if rating == 2 %} active{% endif %}"
                      for="rating-2"
                      >Warning
                    </label>
                      <input
                        type="radio"
                        name="rating"
                        id="rating-3"
                        class="btn-check"
                        value="3"
                        {% if rating == 3 %}checked{% endif %}
                        >
                        <label
                          class="btn btn-outline-danger{% if rating == 3 %} active{% endif %}"
                          for="rating-3"
                          >Fail
                        </label>
            </div>
        </div>
        <div class="btn-group me-2" role="group" aria-label="Third group">
          <button
            class="col-2 btn btn-outline-info"
            type="button"
            id="collapseButton"
            data-bs-toggle="collapse"
            data-bs-target="#collapseComment"
            aria-expanded="false"
            aria-controls="collapseComment"
            >Comment
          </button>
        </div>
      </div>
      <div class="collapse mt-2" id="collapseComment">
        <div class="card bg-light">
          <div class="card-body">
            <div class="form-floating">
              <textarea
                id="comment"
                name="comment"
                class="form-control"
                placeholder="Adding additional information"
                style="height: 100px"
                >
                {%- if comment %}{{ comment }}{% endif -%}
              </textarea>
              <label for="comment">Add additional information</label>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename=('js/auto_submit_rate.js')) }}"></script>
<script src="{{ url_for('static', filename=('js/rate_keybindings.js')) }}"></script>
{% endblock %}
