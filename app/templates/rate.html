{% extends "base.html" %}

{% block help %}
{% include "help_modal.html" %}
{% endblock %}

{% block app_content %}
<div class="row">
  <h1 class="display-4 text-center">
    {{ img_name }}
    {% if rating == 0 %}<span class="badge rounded-pill bg-secondary">Pending</span>
    {% elif rating == 1 %}<span class="badge rounded-pill bg-success">Pass</span>
    {% elif rating == 2 %}<span class="badge rounded-pill bg-warning">Warning</span>
    {% elif rating == 3 %}<span class="badge rounded-pill bg-danger">Fail</span>
    {% endif %}
  </h1>
  <img
    src="{{ url_for('static', filename=(img_path)) }}"
    class="img-fluid"
    alt="{{ img_name }}"
    >
</div>
<div class="row my-3 justify-content-evenly">
  <div class="col-7">
    {% if pag %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <li class="page-item {% if not imgs.has_prev %}disabled{% endif %}">
          <a
            class="page-link"
            id="prevPage"
                         href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
                         page=imgs.prev_num) if imgs.has_prev else '#' }}">
            <i class="bi-arrow-left"></i>
          </a>
        </li>
        {%- for page in imgs.iter_pages(right_current=3) %}
        {% if page %}
        {% if page != imgs.page %}
        <li class="page-item">
          <a
            class="page-link"
                             href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
                             page=page) }}"
                             >{{ page }}</a>
        </li>
        {% else %}
        <li class="page-item active">
          <a
            class="page-link"
            href="#"
            >{{ page }}
          </a>
        </li>
        {% endif %}
        {% else %}
        <li class="page-item disabled">
          <a
            class="page-link"
            href="#"
            ><span class=ellipsis>...<span>
          </a></li>
          {% endif %}
          {%- endfor %}
          <li class="page-item {% if not imgs.has_next %}disabled{% endif %}">
            <a
              class="page-link"
              id="nextPage"
                           href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
                           page=imgs.next_num) if imgs.has_next else '#' }}">
              <i class="bi-arrow-right"></i>
            </a>
          </li>
      </ul>
    </nav>
    {% endif %}
  </div>
  <div class="col-5">
    <form method="post" id="ratingForm">
      {{ form.csrf_token() }}
      <div
        class="btn-toolbar"
        role="toolbar"
        aria-label="Toolbar with button groups"
        >
        <div class="btn-group me-2" role="group" aria-label="First group">
          <input
            type="radio"
            name="rating"
            id="rating-0"
            class="btn-check"
            value="0"
            {% if rating == 0 %}checked{% endif %}
            >
            <label
              class="btn btn-outline-secondary{% if rating == 0 %} active{% endif %}"
              for="rating-0"
              >Pending
            </label>
        </div>
          <div class="btn-group me-2" role="group" aria-label="Second group">
            <input
              type="radio"
              name="rating"
              id="rating-1"
              class="btn-check"
              value="1"
              {% if rating == 1 %}checked{% endif %}
              >
              <label
                class="btn btn-outline-success{% if rating == 1 %} active{% endif %}"
                for="rating-1"
                >Pass
              </label>
                <input
                  type="radio"
                  name="rating"
                  id="rating-2"
                  class="btn-check"
                  value="2"
                  {% if rating == 2 %}checked{% endif %}
                  >
                  <label
                    class="btn btn-outline-warning{% if rating == 2 %} active{% endif %}"
                    for="rating-2"
                    >Warning
                  </label>
                    <input
                      type="radio"
                      name="rating"
                      id="rating-3"
                      class="btn-check"
                      value="3"
                      {% if rating == 3 %}checked{% endif %}
                      >
                      <label
                        class="btn btn-outline-danger{% if rating == 3 %} active{% endif %}"
                        for="rating-3"
                        >Fail
                      </label>
          </div>
                    <div class="btn-group me-2" role="group" aria-label="Third group">
                      <button class="col-2 btn btn-outline-info"
                              type="button"
                              id="collapseButton"
                              data-toggle="collapse"
                              data-target="#collapseComment"
                              aria-expanded="false"
                              aria-controls="collapseComment"
                              >Comment
                      </button>
                    </div>
      </div>
            <div class="collapse p-1" id="collapseComment">
              <div class="card bg-light">
                <div class="card-body">
                  <input id="comment"
                         class="form-control"
                         placeholder="Add additional information to your rating"
                         name="comment"
                         value="{% if comment %}{{ comment }}{% endif %}">
                </div>
              </div>
            </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename=('js/auto_submit_rate.js')) }}"></script>
<script src="{{ url_for('static', filename=('js/rate_keybindings.js')) }}"></script>
{% endblock %}
