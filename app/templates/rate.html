{% extends "base.html" %}
{% from 'bootstrap/pagination.html' import render_pager, render_pagination %}
{% from 'bootstrap/form.html' import render_field %}

{% block help %}
{% include "help_modal.html" %}
{% endblock %}

{% block app_content %}
<div class="row">
  <h1 class="display-4">
    {{ img_name }}
    {% if rating == 0 %}<span class="badge badge-secondary">Pending</span>
    {% elif rating == 1 %}<span class="badge badge-success">Pass</span>
    {% elif rating == 2 %}<span class="badge badge-warning">Warning</span>
    {% elif rating == 3 %}<span class="badge badge-danger">Fail</span>
    {% endif %}
  </h1>
  <img
    src="{{ url_for('static', filename=(img_path)) }}"
    class="img-fluid"
    alt="{{ img_name }}"
    >
</div>
<div class="row justify-content-center align-items-center">
  {% if pag %}
    <nav aria-label="Page navigation" class="mt-1 ">
      <ul class="pagination">
        <li class="page-item {% if not imgs.has_prev %}disabled{% endif %}">
          <a
            class="page-link"
            id="prevPage"
            href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
              page=imgs.prev_num) if imgs.has_prev else '#' }}">
            <i class="bi-arrow-left"></i>
          </a>
        </li>
        {%- for page in imgs.iter_pages(right_current=3) %}
          {% if page %}
            {% if page != imgs.page %}
              <li class="page-item">
                <a
                  class="page-link"
                  href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
                  page=page) }}"
                  >{{ page }}</a>
              </li>
            {% else %}
              <li class="page-item active">
                <a
                  class="page-link"
                  href="#"
                  >{{ page }}<span class="sr-only">(current)</span>
                </a>
              </li>
            {% endif %}
          {% else %}
          <li class="page-item disabled">
            <a
              class="page-link"
              href="#"
              ><span class=ellipsis>...<span>
            </a></li>
          {% endif %}
        {%- endfor %}
        <li class="page-item {% if not imgs.has_next %}disabled{% endif %}">
          <a
            class="page-link"
            id="nextPage"
            href="{{ url_for('main.rate', filter=filter, dataset=DS.name,
              page=imgs.next_num) if imgs.has_next else '#' }}">
            <i class="bi-arrow-right"></i>
          </a>
        </li>
      </ul>
    </nav>
  {% endif %}
</div>
<form method="post" id="ratingForm">
  {{ form.csrf_token() }}
  <div
    class="row p-2 m-3 justify-content-around btn-group-toggle"
    data-toggle="buttons"
    >
    <label
      class="col-2 btn btn-outline-secondary{% if rating == 0 %} active{% endif %}"
      >
      <input
        type="radio"
        name="rating"
        id="rating-0"
        class="rating-radio"
        value="0"
        {% if rating == 0 %}checked{% endif %}
      > Pending
    </label>
    <label
      class="col-2 btn btn-outline-success{% if rating == 1 %} active{% endif %}"
      >
      <input
        type="radio"
        name="rating"
        id="rating-1"
        class="rating-radio"
        value="1"
        {% if rating == 1 %}checked{% endif %}
      > Pass
    </label>
    <label
      class="col-2 btn btn-outline-warning{% if rating == 2 %} active{% endif %}"
      >
      <input
        type="radio"
        name="rating"
        id="rating-2"
        class="rating-radio"
        value="2"
        {% if rating == 2 %}checked{% endif %}
      > Warning
    </label>
    <label
      class="col-2 btn btn-outline-danger{% if rating == 3 %} active{% endif %}"
      >
      <input
        type="radio"
        name="rating"
        id="rating-3"
        class="rating-radio"
        value="3"
        {% if rating == 3 %}checked{% endif %}
      > Fail
    </label>
    <button class="col-2 btn btn-outline-info"
            type="button"
            id="collapseButton"
            data-toggle="collapse"
            data-target="#collapseComment"
            aria-expanded="false"
            aria-controls="collapseComment"
    > Comment
    </button>
  </div>
  <div class="collapse p-1" id="collapseComment">
    <div class="card bg-light">
      <div class="card-body">
        <input id="comment"
               class="form-control"
               placeholder="Add additional information to your rating"
               name="comment"
               value="{% if comment %}{{ comment }}{% endif %}">
      </div>
    </div>
  </div>
</form>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename=('js/auto_submit_rate.js')) }}"></script>
<script src="{{ url_for('static', filename=('js/rate_keybindings.js')) }}"></script>
{% endblock %}
